<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📚 Задания для группы</title>
    <link rel="stylesheet" href='assets/css/main.css?v=202512030024'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Шапка -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <h1>Задания для группы</h1>
            </div>
            <p class="subtitle">Все учебные материалы в одном месте • Обновляется регулярно</p>
        </div>
    </header>

    <!-- Основной контент -->
    <main class="container">
        <!-- Статистика -->
        <div class="stats" id="stats">
            <div class="stat-card">
                <i class="fas fa-book-open"></i>
                <h3 id="totalSubjects">0</h3>
                <p>Предметов</p>
            </div>
            <div class="stat-card">
                <i class="fas fa-file-alt"></i>
                <h3 id="totalFiles">0</h3>
                <p>Файлов</p>
            </div>
            <div class="stat-card">
                <i class="fas fa-users"></i>
                <h3>25+</h3>
                <p>Студентов</p>
            </div>
        </div>

        <!-- Сетка предметов -->
        <div id="subjectsGrid" class="subjects-grid">
            <!-- Карточки будут сгенерированы через JavaScript -->
        </div>

        <!-- Инструкция для студентов -->
        <div class="info-card">
            <h3><i class="fas fa-info-circle"></i> Как пользоваться сайтом</h3>
            <ol>
                <li>Найдите свой предмет в списке выше</li>
                <li>Скачайте нужные файлы кнопкой "Скачать"</li>
                <li>Следите за сроками сдачи заданий</li>
                <li>Для вопросов пишите в Telegram: @ваш_логин</li>
            </ol>
        </div>
    </main>

    <!-- Подвал -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-university"></i> Учебные материалы</h4>
                    <p>Сайт создан для удобства учебной группы</p>
                </div>
                <div class="footer-section">
                    <h4><i class="fas fa-question-circle"></i> Помощь</h4>
                    <p>Telegram: @ваш_логин</p>
                </div>
                <div class="footer-section">
                    <h4><i class="fas fa-sync-alt"></i> Обновления</h4>
                    <p>Материалы обновляются каждую неделю</p>
                    <p id="lastUpdate">Последнее обновление: загружается...</p>
                </div>
            </div>
            <div class="copyright">
                <p>© 2025 Задания для группы • <a href="https://github.com/U007U/Syte" target="_blank">GitHub репозиторий</a></p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Динамическое отображение предметов
        window.renderSubjects = function() {
            const subjects = window.SubjectData ? window.SubjectData.getSubjects() : [];
            const container = document.getElementById('subjectsGrid');
            
            if (!container) return;
            
            // Обновляем статистику
            const totalSubjects = subjects.length;
            const totalFiles = subjects.reduce((sum, subject) => sum + (subject.files ? subject.files.length : 0), 0);
            
            document.getElementById('totalSubjects').textContent = totalSubjects;
            document.getElementById('totalFiles').textContent = totalFiles;
            
            // Очищаем контейнер
            container.innerHTML = '';
            
            if (totalSubjects === 0) {
                container.innerHTML = '<div class="no-subjects"><i class="fas fa-book-open fa-3x"></i><h3>Пока нет предметов</h3><p>Администратор добавит задания скоро</p></div>';
                return;
            }
            
            // Генерируем карточки
            subjects.forEach(subject => {
                const card = document.createElement('div');
                card.className = 'subject-card';
                card.dataset.id = subject.id;
                
                // Создаем HTML для карточки
                let filesHTML = '';
                if (subject.files && subject.files.length > 0) {
                    filesHTML = '<div class="file-list">';
                    subject.files.forEach(file => {
                        filesHTML += `
                            <div class="file-item">
                                <div class="file-icon">
                                    ${getFileIcon(file.filename)}
                                </div>
                                <div class="file-info">
                                    <span class="file-name">${escapeHtml(file.name)}</span>
                                    <p class="file-desc">${escapeHtml(file.desc)}</p>
                                </div>
                                <a href="files/${encodeURIComponent(file.filename)}" 
                                   class="download-btn" 
                                   download 
                                   target="_blank">
                                    <i class="fas fa-download"></i> Скачать
                                </a>
                            </div>
                        `;
                    });
                    filesHTML += '</div>';
                } else {
                    filesHTML = '<p class="no-files">Файлы пока не добавлены</p>';
                }
                
                card.innerHTML = `
                    <div class="subject-header">
                        <div>
                            <h3 class="subject-title">${escapeHtml(subject.name)}</h3>
                            <p class="subject-teacher">
                                <i class="fas fa-chalkboard-teacher"></i>
                                ${escapeHtml(subject.teacher)}
                            </p>
                        </div>
                        <span class="subject-badge">${subject.files ? subject.files.length : 0} файлов</span>
                    </div>
                    ${filesHTML}
                    <div class="subject-footer">
                        <small class="text-muted">
                            <i class="far fa-clock"></i>
                            Обновлено: ${subject.createdAt ? new Date(subject.createdAt).toLocaleDateString('ru-RU') : 'Недавно'}
                        </small>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        // Функции для работы с файлами
        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                'doc': 'fas fa-file-word',
                'docx': 'fas fa-file-word',
                'pdf': 'fas fa-file-pdf',
                'txt': 'fas fa-file-alt',
                'xls': 'fas fa-file-excel',
                'xlsx': 'fas fa-file-excel',
                'ppt': 'fas fa-file-powerpoint',
                'pptx': 'fas fa-file-powerpoint',
                'zip': 'fas fa-file-archive',
                'rar': 'fas fa-file-archive'
            };
            return `<i class="${icons[ext] || 'fas fa-file'}"></i>`;
        }

        // Экранирование HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Показать дату обновления
        document.getElementById('lastUpdate').textContent = 
            'Последнее обновление: ' + new Date().toLocaleDateString('ru-RU');
            
        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                renderSubjects();
            }, 100);
        });
    </script>
    
    <!-- Подключаем внешние JS файлы -->
    <script src="assets/js/data.js"></script>
</body>
</html>