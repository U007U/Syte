
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📚 Задания для группы</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Временные стили пока не загрузился main.css */
        body { 
            font-family: 'Inter', sans-serif; 
            margin: 0; 
            padding: 0; 
            background: #f5f7fa; 
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .header { 
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); 
            color: white; 
            padding: 2rem 0; 
            text-align: center; 
            margin-bottom: 2rem; 
        }
        .subject-card { 
            background: white; 
            padding: 1.5rem; 
            border-radius: 10px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            margin: 1rem 0; 
        }
        .admin-buttons { 
            margin-top: 1rem; 
            padding-top: 1rem; 
            border-top: 1px solid #eee; 
            display: none; 
        }
        .admin-buttons button { 
            margin-right: 10px; 
            padding: 5px 10px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        .btn-edit { background: #4CAF50; color: white; }
        .btn-delete { background: #f44336; color: white; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <!-- Кнопка админа -->
    <button id="adminToggle" class="admin-toggle" title="Режим администратора" onclick="toggleAdmin()">
        <i class="fas fa-user-shield"></i>
    </button>

    <!-- Шапка -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <h1>Задания для группы</h1>
            </div>
            <p class="subtitle">Все учебные материалы в одном месте • Обновляется регулярно</p>
        </div>
    </header>

    <!-- Основной контент -->
    <main class="container">
        <!-- Статистика -->
        <div class="stats" id="stats">
            <div class="stat-card">
                <i class="fas fa-book-open"></i>
                <h3 id="totalSubjects">0</h3>
                <p>Предметов</p>
            </div>
            <div class="stat-card">
                <i class="fas fa-file-alt"></i>
                <h3 id="totalFiles">0</h3>
                <p>Файлов</p>
            </div>
            <div class="stat-card">
                <i class="fas fa-users"></i>
                <h3>25+</h3>
                <p>Студентов</p>
            </div>
        </div>

        <!-- Сетка предметов -->
        <div id="subjectsGrid" class="subjects-grid">
            <!-- Карточки будут сгенерированы через JavaScript -->
        </div>

        <!-- Инструкция для студентов -->
        <div class="info-card">
            <h3><i class="fas fa-info-circle"></i> Как пользоваться сайтом</h3>
            <ol>
                <li>Найдите свой предмет в списке выше</li>
                <li>Скачайте нужные файлы кнопкой "Скачать"</li>
                <li>Следите за сроками сдачи заданий</li>
                <li>Для вопросов пишите в Telegram: @ваш_логин</li>
                <li>Администратор добавляет новые задания регулярно</li>
            </ol>
        </div>

        <!-- Админ-панель (скрыта по умолчанию) -->
        <div id="adminPanel" class="admin-panel hidden">
            <div class="admin-header">
                <h3><i class="fas fa-cogs"></i> Панель администратора</h3>
                <button onclick="logoutAdmin()" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i> Выйти
                </button>
            </div>
            
            <div class="admin-section">
                <h4><i class="fas fa-plus-circle"></i> Добавить новый предмет</h4>
                <div class="admin-form">
                    <input type="text" id="subjectName" placeholder="Название предмета" class="form-input">
                    <input type="text" id="teacherName" placeholder="Имя преподавателя" class="form-input">
                    <button onclick="addNewSubject()" class="btn-primary">
                        <i class="fas fa-plus"></i> Добавить предмет
                    </button>
                </div>
            </div>
            
            <div class="admin-section">
                <h4><i class="fas fa-upload"></i> Инструкция по загрузке файлов</h4>
                <div class="upload-instruction">
                    <p>1. Загрузите файлы на GitHub в папку <code>/files/</code></p>
                    <p>2. Запомните точное имя файла (например: <code>темы_рефератов.docx</code>)</p>
                    <p>3. Добавьте файл к предмету через эту панель</p>
                    <a href="https://github.com/U007U/Syte/upload/main/files" 
                       target="_blank" 
                       class="btn-secondary">
                        <i class="fab fa-github"></i> Открыть GitHub
                    </a>
                </div>
            </div>
            
            <div class="admin-notice">
                <p><strong>Пароль администратора по умолчанию:</strong> <code>admin123</code></p>
                <p>Изменить пароль можно в файле <code>assets/js/data.js</code></p>
            </div>
        </div>
    </main>

    <!-- Подвал -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-university"></i> Учебные материалы</h4>
                    <p>Сайт создан для удобства учебной группы</p>
                </div>
                <div class="footer-section">
                    <h4><i class="fas fa-question-circle"></i> Помощь</h4>
                    <p>Telegram: @ваш_логин</p>
                    <p>Пароль админа: admin123</p>
                </div>
                <div class="footer-section">
                    <h4><i class="fas fa-sync-alt"></i> Обновления</h4>
                    <p>Материалы обновляются каждую неделю</p>
                    <p id="lastUpdate">Последнее обновление: загружается...</p>
                </div>
            </div>
            <div class="copyright">
                <p>© 2024 Задания для группы • <a href="https://github.com/U007U/Syte" target="_blank">GitHub репозиторий</a></p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Глобальные переменные
        let isAdminMode = false;

        // Динамическое отображение предметов
        window.renderSubjects = function() {
            const subjects = window.SubjectData ? window.SubjectData.getSubjects() : [];
            const container = document.getElementById('subjectsGrid');
            
            if (!container) return;
            
            // Обновляем статистику
            const totalSubjects = subjects.length;
            const totalFiles = subjects.reduce((sum, subject) => sum + (subject.files ? subject.files.length : 0), 0);
            
            document.getElementById('totalSubjects').textContent = totalSubjects;
            document.getElementById('totalFiles').textContent = totalFiles;
            
            // Очищаем контейнер
            container.innerHTML = '';
            
            if (totalSubjects === 0) {
                container.innerHTML = `
                    <div class="no-subjects">
                        <i class="fas fa-book-open fa-3x"></i>
                        <h3>Пока нет предметов</h3>
                        <p>Администратор добавит задания скоро</p>
                    </div>
                `;
                return;
            }
            
            // Генерируем карточки
            subjects.forEach(subject => {
                const card = document.createElement('div');
                card.className = 'subject-card';
                card.dataset.id = subject.id;
                
                card.innerHTML = `
                    <div class="subject-header">
                        <div>
                            <h3 class="subject-title">${escapeHtml(subject.name)}</h3>
                            <p class="subject-teacher">
                                <i class="fas fa-chalkboard-teacher"></i>
                                ${escapeHtml(subject.teacher)}
                            </p>
                        </div>
                        <span class="subject-badge">${subject.files ? subject.files.length : 0} файлов</span>
                    </div>
                    
                    ${subject.files && subject.files.length > 0 ? `
                        <div class="file-list">
                            ${subject.files.map(file => `
                                <div class="file-item">
                                    <div class="file-icon">
                                        ${getFileIcon(file.filename)}
                                    </div>
                                    <div class="file-info">
                                        <span class="file-name">${escapeHtml(file.name)}</span>
                                        <p class="file-desc">${escapeHtml(file.desc)}</p>
                                    </div>
                                    <a href="files/${encodeURIComponent(file.filename)}" 
                                       class="download-btn" 
                                       download 
                                       target="_blank">
                                        <i class="fas fa-download"></i> Скачать
                                    </a>
                                </div>
                            `).join('')}
                        </div>
                    ` : '<p class="no-files">Файлы пока не добавлены</p>'}
                    
                    <div class="admin-buttons" id="admin-buttons-${subject.id}" style="display: ${isAdminMode ? 'block' : 'none'}">
                        <button onclick="editSubject(${subject.id})" class="btn-edit">
                            <i class="fas fa-edit"></i> Редактировать
                        </button>
                        <button onclick="deleteSubject(${subject.id})" class="btn-delete">
                            <i class="fas fa-trash"></i> Удалить
                        </button>
                    </div>
                    
                    <div class="subject-footer">
                        <small class="text-muted">
                            <i class="far fa-clock"></i>
                            Обновлено: ${subject.createdAt ? new Date(subject.createdAt).toLocaleDateString('ru-RU') : 'Недавно'}
                        </small>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        // Функции для работы с файлами
        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                'doc': 'fas fa-file-word',
                'docx': 'fas fa-file-word',
                'pdf': 'fas fa-file-pdf',
                'txt': 'fas fa-file-alt',
                'xls': 'fas fa-file-excel',
                'xlsx': 'fas fa-file-excel',
                'ppt': 'fas fa-file-powerpoint',
                'pptx': 'fas fa-file-powerpoint',
                'zip': 'fas fa-file-archive',
                'rar': 'fas fa-file-archive'
            };
            return `<i class="${icons[ext] || 'fas fa-file'}"></i>`;
        }

        // Экранирование HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Админ-функции
        function toggleAdmin() {
            if (isAdminMode) {
                logoutAdmin();
                return;
            }
            
            const password = prompt('Введите пароль администратора:');
            if (window.SubjectData && window.SubjectData.checkAdminPassword(password)) {
                isAdminMode = true;
                document.getElementById('adminPanel').classList.remove('hidden');
                document.getElementById('adminToggle').innerHTML = '<i class="fas fa-user-cog"></i>';
                document.getElementById('adminToggle').classList.add('active');
                
                // Показываем кнопки админа
                document.querySelectorAll('.admin-buttons').forEach(btn => {
                    btn.style.display = 'block';
                });
                
                alert('Режим администратора активирован!');
            } else if (password) {
                alert('Неверный пароль!');
            }
        }
        
        function logoutAdmin() {
            isAdminMode = false;
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('adminToggle').innerHTML = '<i class="fas fa-user-shield"></i>';
            document.getElementById('adminToggle').classList.remove('active');
            
            // Скрываем кнопки админа
            document.querySelectorAll('.admin-buttons').forEach(btn => {
                btn.style.display = 'none';
            });
            
            alert('Вы вышли из режима администратора');
        }
        
        function addNewSubject() {
            const name = document.getElementById('subjectName').value.trim();
            const teacher = document.getElementById('teacherName').value.trim();
            
            if (!name || !teacher) {
                alert('Заполните название предмета и имя преподавателя!');
                return;
            }
            
            if (window.SubjectData) {
                window.SubjectData.addSubject({
                    name: name,
                    teacher: teacher,
                    files: []
                });
                
                alert(`Предмет "${name}" добавлен!`);
                document.getElementById('subjectName').value = '';
                document.getElementById('teacherName').value = '';
                
                // Обновляем отображение
                renderSubjects();
            } else {
                alert('Ошибка: данные не загружены');
            }
        }
        
        function deleteSubject(id) {
            if (!confirm('Удалить этот предмет? Все файлы будут удалены.')) return;
            
            if (window.SubjectData && window.SubjectData.deleteSubject(id)) {
                alert('Предмет удален!');
                renderSubjects();
            } else {
                alert('Ошибка при удалении!');
            }
        }
        
        function editSubject(id) {
            const subject = window.SubjectData ? window.SubjectData.getSubjectById(id) : null;
            if (!subject) return;
            
            const newName = prompt('Новое название предмета:', subject.name);
            if (!newName) return;
            
            const newTeacher = prompt('Имя преподавателя:', subject.teacher);
            
            if (window.SubjectData.updateSubject(id, {
                name: newName,
                teacher: newTeacher
            })) {
                alert('Предмет обновлен!');
                renderSubjects();
            }
        }
        
        // Показать дату обновления
        document.getElementById('lastUpdate').textContent = 
            'Последнее обновление: ' + new Date().toLocaleDateString('ru-RU');
            
        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            // Ждем загрузки данных
            setTimeout(() => {
                renderSubjects();
                
                // Слушаем изменения в localStorage
                window.addEventListener('storage', (e) => {
                    if (e.key === 'subjects_data') {
                        renderSubjects();
                    }
                });
            }, 100);
        });
    </script>
    
    <!-- Подключаем внешние JS файлы -->
    <script src="assets/js/data.js"></script>
</body>
</html>










